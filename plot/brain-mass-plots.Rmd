---
title: "brain-size-neuron-plot"
author: "Charmi"
date: "10/5/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(magrittr)
library(gdata)

```

<center><h1> Goals </h1>
<br>
<i>Load data </i> </center>

```{r, echo=FALSE}
hh <- read.csv("../data/cleaned/herculano-houtzel-all.csv")
```
<center><h2> Plots </h2> </center>
<br>
<br>
<center> <i> Equation of the regression line for plot of 'Brain mass by number of neurons' </i></center>


```{r, echo=FALSE}

#define reg_func for abline

reg_func <- lm(log(N_neurons) ~ log(Mass_g), data = hh)
coeff = coefficients(reg_func)
slp = round(coeff[2],1)
inp = round(coeff[1],1)

#equation of the regression line

eq = paste0("y = ", slp, "*x + ", inp)
```

<center> <h3> Plot of Brain mass by number of neurons </h3></center>
```{r plot, echo = FALSE, fig.align='center'}

#plot the data
hh %>%
    ggplot() +
    aes(x = log(Mass_g), y = log(N_neurons)) +
    labs(x = "Structure mass (g)", y = "Number of Neurons") +
    geom_point() +
    geom_abline(intercept = inp, slope = slp, color = "blue", size = 0.5)

# dataplot + stat_smooth(method="lm", se=FALSE) --> smooth line

#Another way of plotting graph

# lm_func = lm(log(N_neurons) ~ log(Mass_g), data = hh)
# plot(log(N_neurons) ~ log(Mass_g), data=hh, main="Neurons vs mass") + abline(lm_func, col="red")

```
<center> <i> equation of the regression line plotted above is: </i> </center>
```{r regression_line, echo=FALSE}

centerText(eq)

```


